<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <title>Friend Finder</title>
</head>
<body style="background-image: url(images/bg-photo.jpg)">
    <div class="container">
        <div class="row">
            <div class="col">
                <div class="navbar">
                    <p class="text-center">Friend Finder</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <form method="POST">
                    <div class="form-group">
                        <input class="form-control form-control-lg" type="text" placeholder="Enter your name here (required)" id='name' required>
                        <input class="form-control form-control-lg" type="text" placeholder="Enter path to your photo here (required)" id='photo' required>
                    </div>
                    <div class="form-group">
                        <label for="dropDown1">
                            How often do you play sports?
                        </label>
                        <select class="form-control dd" id="dropDown1">
                            <option value='1'>1 (very rarely)</option>
                            <option value='2'>2</option>
                            <option value='3'>3</option>
                            <option value='4'>4</option>
                            <option value='5'>5 (regularly)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dropDown2">
                            How big cinema fan are you?
                        </label>
                        <select class="form-control dd" id="dropDown2">
                            <option value='1'>1 (don't watch movies)</option>
                            <option value='2'>2</option>
                            <option value='3'>3</option>
                            <option value='4'>4</option>
                            <option value='5'>5 (cinephile!)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dropDown3">
                            Are you a book reader?
                        </label>
                        <select class="form-control dd" id="dropDown3">
                            <option value='1'>1 (not really)</option>
                            <option value='2'>2</option>
                            <option value='3'>3</option>
                            <option value='4'>4</option>
                            <option value='5'>5 (book worm!)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dropDown4">
                            Do you like to travel?
                        </label>
                        <select class="form-control dd" id="dropDown4">
                            <option value='1'>1 (not really)</option>
                            <option value='2'>2</option>
                            <option value='3'>3</option>
                            <option value='4'>4</option>
                            <option value='5'>5 (wanderer!)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dropDown5">
                            Are you extrovert/introvert?
                        </label>
                        <select class="form-control dd" id="dropDown5">
                            <option value='1'>1 (introvert)</option>
                            <option value='2'>2</option>
                            <option value='3'>3</option>
                            <option value='4'>4</option>
                            <option value='5'>5 (extrovert)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dropDown6">
                            Do you like clubbing/Partying?
                        </label>
                        <select class="form-control dd" id="dropDown6">
                            <option value='1'>1 (not at all!)</option>
                            <option value='2'>2</option>
                            <option value='3'>3</option>
                            <option value='4'>4</option>
                            <option value='5'>5 (party animal!)</option>
                        </select>
                    </div>
                    <div class="form-group">
                            <label for="dropDown7">
                                Are you a family guy/girl?
                            </label>
                            <select class="form-control dd" id="dropDown7">
                                <option value='1'>1 (not at all!)</option>
                                <option value='2'>2</option>
                                <option value='3'>3</option>
                                <option value='4'>4</option>
                                <option value='5'>5 (totally!)</option>
                            </select>
                        </div>
                        <div class="form-group">
                                <label for="dropDown8">
                                    Do you like adventures?
                                </label>
                                <select class="form-control dd" id="dropDown8">
                                    <option value='1'>1 (not at all!)</option>
                                    <option value='2'>2</option>
                                    <option value='3'>3</option>
                                    <option value='4'>4</option>
                                    <option value='5'>5 (adrinalin junky!)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                    <label for="dropDown9">
                                        Are you agressive in nature?
                                    </label>
                                    <select class="form-control dd" id="dropDown9">
                                        <option value='1'>1 (not at all!)</option>
                                        <option value='2'>2</option>
                                        <option value='3'>3</option>
                                        <option value='4'>4</option>
                                        <option value='5'>5 (yup!)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                        <label for="dropDown10">
                                            Do like big social circle?
                                        </label>
                                        <select class="form-control dd" id="dropDown10">
                                            <option value='1'>1 (not at all!)</option>
                                            <option value='2'>2</option>
                                            <option value='3'>3</option>
                                            <option value='4'>4</option>
                                            <option value='5'>5 (social animal!)</option>
                                        </select>
                                    </div>
                    <button type="submit" class="btn btn-primary" id='dataSubmit'>Submit</button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <a href="/api/friends">API friends list</a> | <a href="https://github.com/JackSparrow114/FriendFinder">GitHub Repo</a>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        // Question: What does this code do?
        $("#dataSubmit").on("click", function(event) {
            var bestMatch;
            console.log(event);
            event.preventDefault();
            var choices = [];
            var dds = document.getElementsByClassName('dd');
            for (let i =0; i< dds.length; i++){
                var char1 = dds[i].value;
                choices.push(parseInt(char1));
            }
            var newFriend = {
                name: $("#name").val().trim(),
                photo: $("#photo").val().trim(),
                scores: choices
            };

            $.get("/api/friends")
            .then(function(data){
                data = JSON.parse(data);
                bestMatch = findClosest(data, choices);
                console.log(bestMatch);
            });
            
            $.post("/api/friends", newFriend)
            .then(function(data) {
                console.log(data);
            });
        });
        // Question: What does this code do??
        findClosest(objArr, scrArr){
            var bestMatch = 0, bestScore = 0;
            for(let i=0;i<objArr.length;i++){
                var tempScore = calculateDiff(objArr[i].scores, scrArr);
                if(tempScore > bestScore){
                    bestScore = tempScore;
                    bestMatch = i;
                }
            }
            return bestMatch;
        }

        calculateDiff(arr1, arr2){
            var diff = 0;
            for(let j=0; j<arr1.length; j++){
                diff += Math.abs(parseInt(arr1[j]) - parseInt(arr2[j]));
            }
            return diff;
        }
    </script>
</body>
</html>